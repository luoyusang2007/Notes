# 面向流和面向包
- TCP是面向数据流的，而UDP是面向包的。
  - TCP存在粘包问题，而UDP不存在。
  - TCP包一定顺序到达，而UDP不一定。
  - TCP适合发长数据，而不适合发一段一段的数据，因为你要自己设计分包机制（在包头中声明长度，或者重新编码增加分隔符）
  - UDP适合发短包（指令，或者小数据块），而不适合发连续的长数据，因为你要自己设计丢包重传机制。

# 可靠和不可靠

- TCP是有状态的，而UDP没有
- TCP具有重发机制，UDP没有
- TCP如果某个包没有送达，后面的包即便送达也读不出来，UDP无所谓

# 区分
从TCP和UDP的包结构看，TCP似乎是UDP的子集，好像可以用UDP去伪造TCP包似的，但其实不然。区分TCP和UDP靠的不是TCP或UDP包信息，而是上层（IP层）中的包信息。IP 包头中有协议代码字段，8位，表明使用该包裹的上层协议，如 TCP=6，ICMP=1，UDP=17 等。

# SOCKET

TCP和UDP的端口号是独立的。也就是说，同一主机上TCP的8080端口和UDP8080端口一点关系都没有。

# 面向连接和多拨
## TCP
- TCP连接需要服务器和客户机的配合。服务器监听，客户机Dial，服务器Accept，通信，完了要Close。而UDP直接发送即可。
- 一般来说，在一个TCP端口上不能开多个连接（不论对象IP端口是否相同）。TCP一个端口监听不同来源的包，或者用一个端口同时监听和发送，需要OS对端口复用支持。在面向连接的UDP中也是类似的。除非使用特殊的标志位，否则不能在同一端口上开多个UDP连接。
- TCP的Listener只能监听远程/本地进程对被监听端口的Dial，不能主动发给别人。

## TCP之上的协议未必是有状态的
HTTP是无连接、无状态的，但是HTTP基于TCP，TCP是有连接、有状态的。这是因为HTTP一次请求-响应后立马关闭TCP连接。而关闭之前，其传输过程都是有连接、有状态的。

## UDP面向连接
虽然UDP本身是无连接的，但是操作系统的Socket机制可以把它抽象成有有连接的，甚至还会赋予它状态。打开到对方主机端口的连接，对方可以打开一个Listener或者打开一个到本机的连接。

## UDP Listener
UDP Listener其实是无状态的UDP收发器。UDP的listener是可以发送的，这也就意味着两个机器，各自开个Listener就可以通信。这样做更符合UDP无连接、无状态的特点。

# 面向包的顺序、可靠协议
如果要结合UDP和TCP的优点